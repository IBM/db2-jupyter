<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Variables - Db2 Magic Commands</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Variables";
    var mkdocs_page_input_path = "variables.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Db2 Magic Commands</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../connect/">Getting Connected</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../linevscell/">SQL Magic Commands</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../sql_options/">SQL Options</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../command_options/">Db2 Magic Command Options</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../plotting/">Plotting</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Variables</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#python-variables">Python Variables</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sql-host-variables">SQL Host Variables</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#arrays-and-in-lists">Arrays and IN Lists</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dictionary-values">Dictionary Values</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../resultsets/">Result Sets</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../stored_procedures/">Stored Procedures</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../developmentsql/">Development SQL</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../pandasdb2/">Pandas to Db2</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../parallel/">Parallel SQL</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../macros/">Macros</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../extramacros/">Predefined Macros</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../support/">Support</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Db2 Magic Commands</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Variables</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="variables">Variables</h1>
<p>The <code>%sql</code> and <code>%%sql</code> statements allow the use of variables within the SQL. This provides some flexibility in the writing your SQL so that you don't need to change the code when you modify one of the search values.</p>
<p>There are two ways of passing a value to a SQL statement:</p>
<ul>
<li>Use Python notation <code>{variable}</code></li>
<li>Use SQL host variables <code>:variable</code></li>
</ul>
<h2 id="python-variables">Python Variables</h2>
<p>The Python variable notation can only be used in single-line <code>%sql</code> statements, while the use of parameter markers is used in either style of SQL statement. The following SQL statement will illustrate the use of variables to modify the SELECT statement:</p>
<pre><code>%sql SELECT * FROM EMPLOYEE WHERE EMPNO = {empno}
</code></pre>
<p>The <code>{empno}</code> field refers to the Python variable called <code>empno</code> and the contents of that variable will be substituted into the statement before execution. The code that you would place into your notebook cell would be:</p>
<pre><code>empno = '000010'
%sql SELECT * FROM EMPLOYEE WHERE EMPNO = {empno}
</code></pre>
<p>By echoing the command, we can see that the substitution was done before the SQL was executed:</p>
<p><img alt="Employee table" src="../img/var7.png" /></p>
<p>You will note that the employee number is <code>000010</code> in the SQL. Luckily, Db2 interpreted the <code>EMPNO</code> in the employee records as a number and compared it to the number that was supplied and was able to find a record match. When you are using Python variable substitution, you must make sure to place quotes around character strings that you need to supply to the SQL. Without quotes, it is possible that the variable will be misinterpreted. To fix this situation, place quotes around the variable as shown in this SQL.</p>
<p><img alt="Employee table" src="../img/var8.png" /></p>
<h2 id="sql-host-variables">SQL Host Variables</h2>
<p>SQL Host variables are similar to Python variables, where the name of the variable is imbedded in the SQL statement. The difference with parameters markers is that the variable name is preceded with a colon <code>:</code> and can be found in single line <code>%sql</code> statements as well as in <code>%%sql</code> blocks.</p>
<p>The employee number example in the previous section can be written as follows:</p>
<pre><code>%sql SELECT * FROM EMPLOYEE WHERE EMPNO = :empno
</code></pre>
<p>In the case of host variables, the Db2 magic command will determine that this is a character string and will place quotes automatically around the variables. You do not need to supply quotes when using this form of parameter substitution.</p>
<p><img alt="Employee table" src="../img/var9.png" /></p>
<p>The host variable can also be used in a <code>%%sql</code> block:</p>
<pre><code>%%sql
SELECT * FROM EMPLOYEE
  WHERE EMPNO = :empno
</code></pre>
<h2 id="arrays-and-in-lists">Arrays and IN Lists</h2>
<p>Variables can also be array types. Arrays are expanded into multiple values, each separated by commas. This is useful when building SQL IN lists. The following example searches for 3 employees based on their employee number.</p>
<pre><code>empnos = ['000010','000020','000030']
%sql SELECT * FROM EMPLOYEE WHERE EMPNO IN (:empnos)
</code></pre>
<p>Note that you must place parenthesis around the variable. SQL requires that the <code>IN</code> list be surrounded by parenthesis. </p>
<p>You can reference individual array items using this technique as well. If you wanted to search for only the first value in the empnos array, use <code>:empnos[0]</code> instead.
<img alt="Employee table" src="../img/var10.png" /></p>
<h2 id="dictionary-values">Dictionary Values</h2>
<p>One final type of variable substitution uses Python dictionaries. Python dictionaries resemble JSON objects and can be used to insert JSON values into Db2. For instance, the following variable contains company information in a JSON structure.</p>
<pre><code>customer = {
    &quot;name&quot; : &quot;Aced Hardware Stores&quot;,
    &quot;city&quot; : &quot;Rockwood&quot;,
    &quot;employees&quot; : 14
}
</code></pre>
<p>The following SQL creates a table with a single VARCHAR column that will be used to store the JSON data.</p>
<pre><code>%%sql
DROP TABLE SHOWJSON;
CREATE TABLE SHOWJSON (INJSON VARCHAR(256));
</code></pre>
<p>To insert the Dictionary (JSON Record) into this Db2 table, you only need to use the variable name as one of the fields being inserted.</p>
<pre><code>%sql INSERT INTO SHOWJSON VALUES :customer
</code></pre>
<p>Selecting from this table will show that the data has been inserted as a string.
<img alt="Employee table" src="../img/var11.png" /></p>
<p>If you want to retrieve the data from a column that contains JSON records, you must use the <code>-j</code> flag to insert the contents back into a variable.
<img alt="Employee table" src="../img/var12.png" /></p>
<p>The data that is returned when using the <code>-j</code> flag will always be an array even if the answer set is one row. </p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../resultsets/" class="btn btn-neutral float-right" title="Result Sets">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../plotting/" class="btn btn-neutral" title="Plotting"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../plotting/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../resultsets/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
